<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User form</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>

<body>
    <header>
        <h1 class="info" style="text-align: center;">Malnad stores</h1>
        <H1 style="text-align: center;">Please fill the form</H1>
        <div class="draw">
            <div class="circle">
            </div>
            <div class="line unfill"></div>
            <div class="circle unfill"></div>
            <div class="line unfill"></div>
            <div class="circle unfill"></div>
        </div>
    </header>

    <body>
        <div class="flex-container border-8 border-black">
            <form action="form2.html" method="get">
                <div class="flex-item">

                    <label for="f_name">First Name:</label>
                    <input type="text" name="f_name" id="f_name" required>

                </div>

                <div class="flex-item">

                    <label for="l_name">Last Name:</label>
                    <input type="text" name="l_name" id="l_name" required>

                </div>
                <div class="flex-item">

                    <label for="contact_no">Contact No:</label>
                    <input type="number" name="contact_no" id="contact_no" required>


                </div>
                <div class="flex-item">

                    <label for="email">Email:</label>
                    <input type="email" oninput="checkEmail()" name="email" id="email" required>

                </div>
                <div class="flex-item">

                    <label for="dob">Date of Birth:</label>
                    <input type="date" name="dob" required oninput="checkAge()" id="dob" class="dob">

                </div>
                <div class="flex-item">

                    <label for="gender">Gender:</label>
                    <input type="text" name="gender" id="gender" required>

                </div>
                <div class="flex-item">

                    <label for="address">Current Address:</label>
                    <input type="text" name="address" id="address" required>

                </div>
                <div class="flex-item">

                    <label for="nation">Nationality</label>
                    <input type="text" name="nation" id="nation" required>

                </div>


                <!-- ========================================================= -->
                <div class="flex-item">
                    <input class="form-check-input" type="checkbox" value="" id="supplierCheckbox" />
                    <label class="form-check-label" for="supplierCheckbox">Be a supplier</label>
                </div>
                
                <div class="flex-item" id="FarmerId" style="display:none;">
                    <label for="verficaton_id">Farmer Id / Identification:</label>
                    <input type="text" name="verficaton_id" id="verficaton_id" required>
                </div>
                
                <div class="flex-item" id="SupplyLocation" style="display:none;">
                    <label for="location">Supply location</label>
                    <input type="text" name="location" id="location" required>
                </div>
                <!-- ========================================================= -->
                <div for="submit" class="flex-item">
                    <input type="submit" value="submit" id="submit" onclick="validateDob()" required>
                </div>

            </form>
            </div:flex-container>
            <br><br><br><br><br><br><br><br><br><br>
    </body>
    <footer>
    </footer>
    <script>

        function validateDob() {
            f_name = document.getElementById("name").value
            l_name = document.getElementById("email").value
            contact = document.getElementById("contact").value
            dob = document.getElementById("dob").value
            gender = document.getElementById("gender").value
            address = document.getElementById("address").value
            nation = document.getElementById("nation").value

        }

        function checkEmail() {
            const email = document.getElementById("email");
            const email_str = email.value;
            const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            const isValid = emailPattern.test(email_str);
            console.log(isValid);

            if (isValid) {
                email.style.borderColor = "green";
            }
            else {

                email.style.borderColor = "red";
            }
        }

        function checkAge() {
            const dobEle = document.getElementById("dob");
            const dob = dobEle.value;
            const year = new Date();
            const arr = dob.split("-");
            const button = document.getElementById("submit");

            console.log(typeof (Number(arr[0])) + " " + typeof (year));

            console.log(arr[0]);
            console.log(year);
            const age = year.getFullYear() - Number(arr[0]);

            console.log(year.getFullYear())
            console.log(age + " = " + year.getFullYear() + " - " + arr[0]);
            if (age >= 18) {
                dobEle.style.borderColor = "green";
                button.disabled = false;
                button.style.background = "#2E86AB";
            }
            else {
                dobEle.style.borderColor = "red";
                button.disabled = true;
                button.style.background = "grey";
            }
        }

        const supplierCheckbox = document.getElementById('supplierCheckbox');
        const farmerIdDiv = document.getElementById('FarmerId');
        const supplyLocationDiv = document.getElementById('SupplyLocation');

        supplierCheckbox.addEventListener('change', function () {
            if (this.checked) {
                farmerIdDiv.style.display = 'block';
                supplyLocationDiv.style.display = 'block';
            } else {
                farmerIdDiv.style.display = 'none';
                supplyLocationDiv.style.display = 'none';
            }
        });

    </script>
</body>

</html>